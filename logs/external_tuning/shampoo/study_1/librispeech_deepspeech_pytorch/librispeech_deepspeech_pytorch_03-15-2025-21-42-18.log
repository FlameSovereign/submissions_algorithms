torchrun --redirects 1:0,2:0,3:0,4:0,5:0,6:0,7:0 --standalone --nnodes=1 --nproc_per_node=8 submission_runner.py --framework=pytorch --workload=librispeech_deepspeech --submission_path=submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py --data_dir=/data/librispeech --num_tuning_trials=1 --experiment_dir=/experiment_runs --experiment_name=submissions/rolling_leaderboard/external_tuning/shampoo/study_1 --overwrite=True --save_checkpoints=False --rng_seed=-929858190 --librispeech_tokenizer_vocab_path=/data/librispeech/spm_model.vocab --torch_compile=true --tuning_ruleset=external --tuning_search_space=submissions_algorithms/leaderboard/external_tuning/shampoo_submission/tuning_search_space.json --num_tuning_trials=5 --hparam_start_index=2 --hparam_end_index=3 2>&1 | tee -a /logs/librispeech_deepspeech_pytorch_03-15-2025-21-42-18.log
W0315 21:42:20.387000 9 site-packages/torch/distributed/run.py:793] 
W0315 21:42:20.387000 9 site-packages/torch/distributed/run.py:793] *****************************************
W0315 21:42:20.387000 9 site-packages/torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0315 21:42:20.387000 9 site-packages/torch/distributed/run.py:793] *****************************************
2025-03-15 21:42:21.425938: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425935: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425936: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425935: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425938: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425935: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425938: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-15 21:42:21.425937: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1742074941.448295      51 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1742074941.448299      47 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1742074941.448296      45 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1742074941.448297      49 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1742074941.448299      48 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1742074941.448296      44 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1742074941.448295      50 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1742074941.448296      46 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1742074941.455006      50 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455010      47 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455010      49 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455010      45 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455010      46 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455013      44 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455009      51 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
E0000 00:00:1742074941.455013      48 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
ERROR:root:Unable to import wandb.
Traceback (most recent call last):
  File "/algorithmic-efficiency/algoperf/logger_utils.py", line 27, in <module>
    import wandb  # pylint: disable=g-import-not-at-top
    ^^^^^^^^^^^^
ModuleNotFoundError: No module named 'wandb'
[rank4]:[W315 21:42:29.434509716 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 4]  using GPU 4 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank2]:[W315 21:42:29.434548567 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank6]:[W315 21:42:29.434559660 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 6]  using GPU 6 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank3]:[W315 21:42:29.434668930 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank7]:[W315 21:42:29.434762909 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 7]  using GPU 7 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank5]:[W315 21:42:29.434811813 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 5]  using GPU 5 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank1]:[W315 21:42:29.434878038 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank0]:[W315 21:42:29.610115756 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
I0315 21:42:31.444194 140696416773312 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444194 140084562695360 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444193 139826424071360 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444193 139796671878336 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444198 140384489272512 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444210 139854132851904 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444270 139941122524352 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:31.444264 140063870936256 logger_utils.py:81] Creating experiment directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch.
I0315 21:42:32.676703 139854132851904 submission_runner.py:606] Using RNG seed -929858190
I0315 21:42:32.677594 139826424071360 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.677598 140696416773312 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.677630 140084562695360 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.677627 139796671878336 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.677637 139941122524352 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.678153 139854132851904 submission_runner.py:615] --- Tuning run 3/5 ---
I0315 21:42:32.678301 139854132851904 submission_runner.py:620] Creating tuning directory at /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3.
I0315 21:42:32.677937 140384489272512 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.678572 139854132851904 logger_utils.py:97] Saving hparams to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:32.711066 140063870936256 logger_utils.py:91] Loading hparams from /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/hparams.json.
I0315 21:42:33.026934 139854132851904 submission_runner.py:218] Initializing dataset.
I0315 21:42:33.027152 139854132851904 input_pipeline.py:20] Loading split = train-clean-100
I0315 21:42:33.068314 139854132851904 input_pipeline.py:20] Loading split = train-clean-360
I0315 21:42:33.218278 139854132851904 input_pipeline.py:20] Loading split = train-other-500
I0315 21:42:33.852127 139854132851904 submission_runner.py:229] Initializing model.
W0315 21:42:39.656025 139796671878336 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.656066 140696416773312 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.656246 139854132851904 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.656549 140384489272512 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.657533 139941122524352 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.657775 140084562695360 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.657859 139826424071360 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:39.668186 140063870936256 submission_runner.py:254] These workloads cannot be fully compiled under current PyTorch version. Proceeding without `torch.compile`.
W0315 21:42:40.623201 140696416773312 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
I0315 21:42:40.623496 139854132851904 submission_runner.py:272] Initializing optimizer.
W0315 21:42:40.625277 140084562695360 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
W0315 21:42:40.626024 139854132851904 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
W0315 21:42:40.627848 139941122524352 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
I0315 21:42:40.628129 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([512, 512]), torch.Size([9, 9])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
W0315 21:42:40.628817 140384489272512 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
I0315 21:42:40.628895 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([512, 512])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.629130 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.629429 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.629638 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.629736 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([512, 512])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.629874 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.629992 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.630046 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.630187 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.630316 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.630452 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.630611 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.630729 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.630908 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.631347 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.631531 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.631680 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.631737 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.631829 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
W0315 21:42:40.631776 139796671878336 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
I0315 21:42:40.631908 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.631962 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.632048 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.632085 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.632100 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.632136 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([512, 512]), torch.Size([512, 512]), torch.Size([9, 9])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.632174 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.632206 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.632283 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.632290 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.632316 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.632380 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.632538 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.632560 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.632709 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.632684 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.632844 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.632826 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.632961 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.632975 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.632983 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.632994 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([512, 512])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633093 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.633103 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.633031 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.633115 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.633130 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633196 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633231 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.633243 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633272 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.633301 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633356 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.633390 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.633407 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633451 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.633477 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.633488 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.633531 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.633584 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.633601 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.633682 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.633593 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633742 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.633750 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.633782 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.633843 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633864 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.633875 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.633899 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.633940 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.633983 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.633987 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.634043 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.634052 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.634082 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634097 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.634172 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.634182 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.634186 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634196 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.634271 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634300 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.634381 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.634391 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.634404 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634474 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.634500 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634529 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.634599 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.634631 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.634678 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.634673 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([512, 512])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.634728 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.634755 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.634791 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.634809 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.634820 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634856 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634916 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.634926 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.634952 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635039 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.635039 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.635046 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.635138 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.635160 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.635252 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635258 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.635343 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635376 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
W0315 21:42:40.635276 139826424071360 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
I0315 21:42:40.635434 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.635462 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635466 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.635524 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.635564 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635657 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.635637 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.635701 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.635762 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635807 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.635824 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.635836 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.635918 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635931 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([1024, 1024])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.635947 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.635980 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.635931 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.636011 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636067 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.636084 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636092 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636103 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636126 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636137 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636184 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636188 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636197 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.636291 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.636306 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636312 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.636317 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636331 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.636410 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636425 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.636428 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.636459 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636515 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636521 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636520 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636532 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.636615 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636633 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636644 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636652 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636734 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.636737 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636742 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636741 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.636757 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.636749 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.636843 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636850 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.636854 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.636873 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636936 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636937 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.636976 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.637022 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637031 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([1024, 1024])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637077 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637119 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637171 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637200 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637222 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637274 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637317 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637345 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.637368 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637446 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.637471 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.637495 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.637530 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.637573 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637569 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.637642 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.637660 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637681 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637725 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.637764 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637774 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637787 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([512, 512])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637808 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.637847 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637872 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637903 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.637921 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.637919 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.637944 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.637999 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638011 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638029 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638036 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638068 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638094 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638076 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.638123 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638125 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638163 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638187 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638212 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638217 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638238 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.638272 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638276 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638287 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638304 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638304 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638388 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638389 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638390 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.638396 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638408 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638482 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638497 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638501 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638509 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638525 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.638595 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638607 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638610 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638626 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638664 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.638692 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.638695 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638726 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638738 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638790 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.638817 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638829 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638813 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([1024, 1024])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638826 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638835 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638912 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.638921 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.638947 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.638949 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638949 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.638964 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.639034 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639035 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.639036 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639078 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.639096 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.639126 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639137 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639175 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639184 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639219 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639256 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.639270 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639320 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639354 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639381 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.639333 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([1024, 1024])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639441 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.639446 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639407 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.639482 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639559 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.639585 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639578 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.639615 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639673 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639709 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.639742 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.639767 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639805 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639848 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639838 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.639885 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.639898 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.639945 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640009 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.640018 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640040 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.639967 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640108 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640129 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640181 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.640201 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640222 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640237 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.640240 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([512, 512])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640252 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640308 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640312 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.640319 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640328 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640362 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640379 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.640384 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640403 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640405 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640421 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640474 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640472 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640491 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.640494 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640496 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640505 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640508 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.640616 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.640619 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640621 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.640650 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.640567 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640598 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640709 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640711 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640737 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.640767 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640783 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.640787 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640796 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640831 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640881 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640878 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640870 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([1024, 1024])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.640889 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.640909 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.640929 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641000 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641001 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.641023 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641030 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641043 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641086 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641120 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641154 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.641170 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641203 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.641242 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641254 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641258 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641302 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641373 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.641375 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.641396 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641459 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641468 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641490 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641563 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641608 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641552 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641726 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641753 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.641758 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641852 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641852 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.641875 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641903 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.641938 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.641951 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.641969 139854132851904 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642037 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642038 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642071 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.642136 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642143 139854132851904 shampoo_preconditioner_list.py:612] Rank 0: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.642148 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.642182 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642189 139854132851904 shampoo_preconditioner_list.py:615] Rank 0: ShampooPreconditionerList Bytes Breakdown: (2097800,)
I0315 21:42:40.642230 139854132851904 shampoo_preconditioner_list.py:618] Rank 0: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.642204 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([1024, 1024])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642230 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642232 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642271 139854132851904 shampoo_preconditioner_list.py:621] Rank 0: ShampooPreconditionerList Total Bytes: 2097800
I0315 21:42:40.642279 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642314 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642340 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.642407 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642411 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.642431 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.642459 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.642535 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.642533 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.642559 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642595 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.642618 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.642632 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642654 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642662 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642744 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.642744 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642753 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642717 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642841 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642847 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.642828 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([512, 512])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642878 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.642905 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642933 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.642950 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.643026 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.643054 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.643093 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.643118 140084562695360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643175 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.643278 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643302 140084562695360 shampoo_preconditioner_list.py:612] Rank 1: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.643355 140084562695360 shampoo_preconditioner_list.py:615] Rank 1: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760)
I0315 21:42:40.643375 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643395 140084562695360 shampoo_preconditioner_list.py:618] Rank 1: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.643440 140084562695360 shampoo_preconditioner_list.py:621] Rank 1: ShampooPreconditionerList Total Bytes: 20972816
I0315 21:42:40.643468 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.643504 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.643634 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.643639 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.643732 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643731 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643758 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([512, 512])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.643815 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643827 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.643838 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.643900 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.643918 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.643961 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644004 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644017 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644014 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644050 139854132851904 submission.py:142] No large parameters detected! Continuing with only Shampoo....
I0315 21:42:40.644100 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644109 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644119 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644130 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644208 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644233 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644250 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644271 139854132851904 submission_runner.py:279] Initializing metrics bundle.
I0315 21:42:40.644304 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644341 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644356 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644397 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644412 139854132851904 submission_runner.py:301] Initializing checkpoint and logger.
I0315 21:42:40.644435 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644447 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644437 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([512, 512])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644515 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644532 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644555 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644630 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644645 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644669 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644654 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([1024, 1024])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644681 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644736 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644768 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644772 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644785 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.644832 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644860 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644875 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644885 139854132851904 submission_runner.py:321] Saving meta data to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/meta_data_0.json.
I0315 21:42:40.644937 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([1024, 1024])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.644952 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.644964 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.644976 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645049 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.645061 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.645085 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.645093 139854132851904 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.645102 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([1024, 1024])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645138 139854132851904 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.645144 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.645180 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645231 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.645255 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.645227 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.645274 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645359 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.645366 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.645373 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.645385 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.645451 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.645459 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645493 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645543 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645574 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.645687 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.645683 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([1024, 1024])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645720 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.645821 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645828 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.645916 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645914 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645925 140084562695360 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.646003 140084562695360 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.646012 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.645994 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([1024, 1024])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646034 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.646097 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646107 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([512, 512]), torch.Size([512, 512])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.646152 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.646170 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([1024, 1024])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646202 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646238 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646254 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646301 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646296 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([512, 512])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646319 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.646341 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646365 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646428 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646434 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.646440 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646462 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646528 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646531 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646564 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.646584 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.646630 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646662 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.646683 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646700 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.646750 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.646758 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646775 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646802 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.646844 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646822 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([512, 512])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646862 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646937 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.646973 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.646981 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.647067 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.647143 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.647248 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.647351 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.647392 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.647478 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.647530 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.647574 139941122524352 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.647564 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([1024, 1024])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.647638 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.647729 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.647734 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.647782 139941122524352 shampoo_preconditioner_list.py:612] Rank 3: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.647835 139941122524352 shampoo_preconditioner_list.py:615] Rank 3: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760, 10485760)
I0315 21:42:40.647832 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.647859 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.647875 139941122524352 shampoo_preconditioner_list.py:618] Rank 3: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.647909 139941122524352 shampoo_preconditioner_list.py:621] Rank 3: ShampooPreconditionerList Total Bytes: 31458576
I0315 21:42:40.647879 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([1024, 1024])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.647949 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.647954 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.648015 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.648044 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648104 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([1024, 1024])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.648144 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648122 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([512, 512]), torch.Size([512, 512])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.648237 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648255 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648355 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.648362 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648449 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648453 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648542 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648576 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.648643 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648693 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648687 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.648725 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([512, 512])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648770 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.648842 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.648863 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648871 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648872 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.648969 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.649004 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.649007 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([1024, 1024])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.648947 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.649092 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.649111 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.649121 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.649188 140384489272512 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.649214 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.649385 140384489272512 shampoo_preconditioner_list.py:612] Rank 4: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.649444 140384489272512 shampoo_preconditioner_list.py:615] Rank 4: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760, 10485760)
I0315 21:42:40.649485 140384489272512 shampoo_preconditioner_list.py:618] Rank 4: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.649523 140384489272512 shampoo_preconditioner_list.py:621] Rank 4: ShampooPreconditionerList Total Bytes: 31458576
I0315 21:42:40.649631 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([512, 512])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.649789 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.649902 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.650010 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([512, 512])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.650036 139796671878336 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.650175 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.650228 139796671878336 shampoo_preconditioner_list.py:612] Rank 2: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.650283 139796671878336 shampoo_preconditioner_list.py:615] Rank 2: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760)
I0315 21:42:40.650323 139796671878336 shampoo_preconditioner_list.py:618] Rank 2: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.650310 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([512, 512])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.650362 139796671878336 shampoo_preconditioner_list.py:621] Rank 2: ShampooPreconditionerList Total Bytes: 20972816
I0315 21:42:40.650462 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.650500 139941122524352 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.650568 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.650580 139941122524352 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.650923 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.651133 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([1024, 1024])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.651165 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([512, 512])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.651256 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.651304 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.651386 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.651443 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.651520 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.652154 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([512, 512])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.652194 140384489272512 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.652280 140384489272512 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.652293 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([1024, 1024])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.652401 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.652450 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.652683 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.653000 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([512, 512])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.653023 139796671878336 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.653095 139796671878336 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.653171 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.653275 140696416773312 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.653268 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([512, 512])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.653432 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.653520 140696416773312 shampoo_preconditioner_list.py:612] Rank 6: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.653578 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.653595 140696416773312 shampoo_preconditioner_list.py:615] Rank 6: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 2097152, 2097152, 2097152, 10485760, 8912896, 8388608, 8388608, 10485760, 8912896, 8388608, 8388608, 2097152, 2097152, 10485760, 8912896, 8388608)
I0315 21:42:40.653635 140696416773312 shampoo_preconditioner_list.py:618] Rank 6: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.653712 140696416773312 shampoo_preconditioner_list.py:621] Rank 6: ShampooPreconditionerList Total Bytes: 225969424
I0315 21:42:40.653799 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([1024, 1024])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.653930 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.654079 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.654206 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.654381 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([1024, 1024])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.654499 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.654613 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.655133 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([512, 512])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.655301 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.655442 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.656060 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([1024, 1024])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.656202 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.656347 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.656697 140696416773312 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.656779 140696416773312 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.656950 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.658487 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([1024, 1024])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.658648 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.658760 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.660413 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([512, 512])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.662075 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.662268 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.662451 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([1024, 1024])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.662585 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.662723 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.662855 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.664945 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([1024, 1024])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.665089 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.665189 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.667104 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([512, 512])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.667282 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.667392 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.668119 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([512, 512])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.668261 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.668394 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.669616 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([512, 512])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.669773 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.672001 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([512, 512])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.672177 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.672287 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.674900 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([512, 512])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.675048 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.675179 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.675371 139826424071360 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([1024, 1024])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.675683 139826424071360 shampoo_preconditioner_list.py:612] Rank 7: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.675745 139826424071360 shampoo_preconditioner_list.py:615] Rank 7: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 10485760, 2097152, 2097152, 2097152, 10485760, 8912896, 8388608, 8388608, 10485760, 8912896, 8388608, 8388608, 2097152, 2097152, 10485760, 8912896, 8388608, 8388608, 10485760)
I0315 21:42:40.675794 139826424071360 shampoo_preconditioner_list.py:618] Rank 7: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.675843 139826424071360 shampoo_preconditioner_list.py:621] Rank 7: ShampooPreconditionerList Total Bytes: 244843792
I0315 21:42:40.681417 139826424071360 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.681500 139826424071360 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
W0315 21:42:40.750367 140063870936256 distributed_shampoo.py:341] start_preconditioning_step set to -1. Setting start_preconditioning_step equal to precondition frequency 100 by default.
I0315 21:42:40.755623 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 0.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 0 (torch.Size([512, 1, 3, 3])), Block block_0 (torch.Size([512, 9])).
I0315 21:42:40.755815 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 1.block_0 ([torch.Size([0])]) for Parameter 1 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.756014 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 2.block_0 ([torch.Size([0]), torch.Size([0]), torch.Size([0])]) for Parameter 2 (torch.Size([512, 512, 3, 3])), Block block_0 (torch.Size([512, 512, 9])).
I0315 21:42:40.756138 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 3.block_0 ([torch.Size([0])]) for Parameter 3 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.756402 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_0 (torch.Size([512, 1024])).
I0315 21:42:40.756553 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_1 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_1 (torch.Size([512, 1024])).
I0315 21:42:40.756668 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_2 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_2 (torch.Size([512, 1024])).
I0315 21:42:40.756795 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_3 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_3 (torch.Size([512, 1024])).
I0315 21:42:40.758518 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_4 ([torch.Size([512, 512]), torch.Size([1024, 1024])]) for Parameter 4 (torch.Size([512, 10240])), Block block_4 (torch.Size([512, 1024])).
I0315 21:42:40.758681 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_5 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_5 (torch.Size([512, 1024])).
I0315 21:42:40.758795 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_6 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_6 (torch.Size([512, 1024])).
I0315 21:42:40.758915 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_7 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_7 (torch.Size([512, 1024])).
I0315 21:42:40.759031 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_8 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_8 (torch.Size([512, 1024])).
I0315 21:42:40.759145 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 4.block_9 ([torch.Size([0]), torch.Size([0])]) for Parameter 4 (torch.Size([512, 10240])), Block block_9 (torch.Size([512, 1024])).
I0315 21:42:40.759237 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 5.block_0 ([torch.Size([0])]) for Parameter 5 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.759357 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 6.block_0 ([torch.Size([0])]) for Parameter 6 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.759465 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 7.block_0 ([torch.Size([0])]) for Parameter 7 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.759582 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 8.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 8 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.759701 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 9.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 9 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.759795 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 10.block_0 ([torch.Size([0])]) for Parameter 10 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.759877 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 11.block_0 ([torch.Size([0])]) for Parameter 11 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.761420 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 12.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 12 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.761585 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 13.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 13 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.761697 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 14.block_0 ([torch.Size([0])]) for Parameter 14 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.761788 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 15.block_0 ([torch.Size([0])]) for Parameter 15 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.761896 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 16.block_0 ([torch.Size([0])]) for Parameter 16 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.761983 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 17.block_0 ([torch.Size([0])]) for Parameter 17 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.762103 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 18.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 18 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.762316 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 19.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 19 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.762439 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 20.block_0 ([torch.Size([0])]) for Parameter 20 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.762545 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 21.block_0 ([torch.Size([0])]) for Parameter 21 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.762666 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 22.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 22 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.762781 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 23.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 23 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.762875 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 24.block_0 ([torch.Size([0])]) for Parameter 24 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.762962 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 25.block_0 ([torch.Size([0])]) for Parameter 25 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.763054 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 26.block_0 ([torch.Size([0])]) for Parameter 26 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.763144 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 27.block_0 ([torch.Size([0])]) for Parameter 27 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.763257 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 28.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 28 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.763381 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 29.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 29 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.763506 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 30.block_0 ([torch.Size([0])]) for Parameter 30 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.763606 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 31.block_0 ([torch.Size([0])]) for Parameter 31 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.763712 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 32.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 32 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.763818 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 33.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 33 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.763921 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 34.block_0 ([torch.Size([0])]) for Parameter 34 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.764008 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 35.block_0 ([torch.Size([0])]) for Parameter 35 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.764181 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 36.block_0 ([torch.Size([0])]) for Parameter 36 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.764284 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 37.block_0 ([torch.Size([0])]) for Parameter 37 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.764404 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 38.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 38 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.764526 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 39.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 39 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.764621 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 40.block_0 ([torch.Size([0])]) for Parameter 40 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.764708 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 41.block_0 ([torch.Size([0])]) for Parameter 41 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.764827 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 42.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 42 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.767234 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 43.block_0 ([torch.Size([1024, 1024]), torch.Size([256, 256])]) for Parameter 43 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.767377 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 44.block_0 ([torch.Size([0])]) for Parameter 44 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.767510 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 45.block_0 ([torch.Size([0])]) for Parameter 45 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.767606 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 46.block_0 ([torch.Size([0])]) for Parameter 46 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.767699 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 47.block_0 ([torch.Size([0])]) for Parameter 47 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.770157 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 48.block_0 ([torch.Size([1024, 1024]), torch.Size([512, 512])]) for Parameter 48 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.770340 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 49.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 49 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.770466 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 50.block_0 ([torch.Size([0])]) for Parameter 50 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.770578 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 51.block_0 ([torch.Size([0])]) for Parameter 51 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.770708 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 52.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 52 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.770821 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 53.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 53 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.770907 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 54.block_0 ([torch.Size([0])]) for Parameter 54 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.770993 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 55.block_0 ([torch.Size([0])]) for Parameter 55 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.771075 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 56.block_0 ([torch.Size([0])]) for Parameter 56 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.771157 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 57.block_0 ([torch.Size([0])]) for Parameter 57 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.771264 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 58.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 58 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.771376 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 59.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 59 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.771470 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 60.block_0 ([torch.Size([0])]) for Parameter 60 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.771556 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 61.block_0 ([torch.Size([0])]) for Parameter 61 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.771663 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 62.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 62 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.771776 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 63.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 63 (torch.Size([1024, 256])), Block block_0 (torch.Size([1024, 256])).
I0315 21:42:40.771884 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 64.block_0 ([torch.Size([0])]) for Parameter 64 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.771979 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 65.block_0 ([torch.Size([0])]) for Parameter 65 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.772068 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 66.block_0 ([torch.Size([0])]) for Parameter 66 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772156 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 67.block_0 ([torch.Size([0])]) for Parameter 67 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772283 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 68.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 68 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.772365 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 69.block_0 ([torch.Size([0])]) for Parameter 69 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772464 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 70.block_0 ([torch.Size([0])]) for Parameter 70 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772549 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 71.block_0 ([torch.Size([0])]) for Parameter 71 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772654 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 72.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 72 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.772737 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 73.block_0 ([torch.Size([0])]) for Parameter 73 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772819 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 74.block_0 ([torch.Size([0])]) for Parameter 74 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.772902 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 75.block_0 ([torch.Size([0])]) for Parameter 75 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.774850 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 76.block_0 ([torch.Size([512, 512]), torch.Size([512, 512])]) for Parameter 76 (torch.Size([512, 512])), Block block_0 (torch.Size([512, 512])).
I0315 21:42:40.774994 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 77.block_0 ([torch.Size([0])]) for Parameter 77 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.775173 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 78.block_0 ([torch.Size([0])]) for Parameter 78 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.775276 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 79.block_0 ([torch.Size([0])]) for Parameter 79 (torch.Size([512])), Block block_0 (torch.Size([512])).
I0315 21:42:40.775403 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 80.block_0 ([torch.Size([0]), torch.Size([0])]) for Parameter 80 (torch.Size([1024, 512])), Block block_0 (torch.Size([1024, 512])).
I0315 21:42:40.775506 140063870936256 shampoo_preconditioner_list.py:574] Instantiated Shampoo Preconditioner 81.block_0 ([torch.Size([0])]) for Parameter 81 (torch.Size([1024])), Block block_0 (torch.Size([1024])).
I0315 21:42:40.775688 140063870936256 shampoo_preconditioner_list.py:612] Rank 5: ShampooPreconditionerList Numel Breakdown: (524450, 524288, 1048738, 524288, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 2621440, 524288, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 2621440, 2228224, 2097152, 2097152, 2621440, 2228224, 2097152, 2097152, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 1048576, 524288, 524288, 524288, 2621440, 2097152)
I0315 21:42:40.775743 140063870936256 shampoo_preconditioner_list.py:615] Rank 5: ShampooPreconditionerList Bytes Breakdown: (2097800, 2097152, 4194952, 2097152, 10485760, 10485760)
I0315 21:42:40.775783 140063870936256 shampoo_preconditioner_list.py:618] Rank 5: ShampooPreconditionerList Total Elements: 157811012
I0315 21:42:40.775819 140063870936256 shampoo_preconditioner_list.py:621] Rank 5: ShampooPreconditionerList Total Bytes: 31458576
I0315 21:42:40.779509 140063870936256 logger_utils.py:262] Unable to record workload.train_mean information. Continuing without it.
I0315 21:42:40.779585 140063870936256 logger_utils.py:262] Unable to record workload.train_stddev information. Continuing without it.
I0315 21:42:40.926355 139854132851904 submission_runner.py:325] Saving flags to /experiment_runs/submissions/rolling_leaderboard/external_tuning/shampoo/study_1/librispeech_deepspeech_pytorch/trial_3/flags_0.json.
I0315 21:42:41.040933 139854132851904 submission_runner.py:337] Starting training loop.
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
/algorithmic-efficiency/algoperf/workloads/librispeech_conformer/librispeech_pytorch/preprocessor.py:488: UserWarning: Specified kernel cache directory could not be created! This disables kernel caching. Specified directory is /root/.cache/torch/kernels. This warning will appear only once per process. (Triggered internally at ../aten/src/ATen/native/cuda/jit_utils.cpp:1442.)
  spectrum = torch.abs(spectrum)
I0315 21:44:04.998041 139835142567680 logging_writer.py:48] [0] global_step=0, grad_norm=22.0198, loss=33.6347
I0315 21:44:05.020396 139854132851904 submission.py:265] 0) loss = 33.635, grad_norm = 22.020
I0315 21:44:05.566486 139854132851904 spec.py:321] Evaluating on the training split.
I0315 21:44:05.567445 139854132851904 input_pipeline.py:20] Loading split = train-clean-100
I0315 21:44:05.594608 139854132851904 input_pipeline.py:20] Loading split = train-clean-360
I0315 21:44:05.689085 139854132851904 input_pipeline.py:20] Loading split = train-other-500
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
I0315 21:44:42.268256 139854132851904 spec.py:333] Evaluating on the validation split.
I0315 21:44:42.269682 139854132851904 input_pipeline.py:20] Loading split = dev-clean
I0315 21:44:42.312381 139854132851904 input_pipeline.py:20] Loading split = dev-other
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
/usr/local/lib/python3.11/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
I0315 21:45:04.739255 139854132851904 spec.py:349] Evaluating on the test split.
I0315 21:45:04.740481 139854132851904 input_pipeline.py:20] Loading split = test-clean
I0315 21:45:17.026617 139854132851904 submission_runner.py:469] Time since start: 155.99s, 	Step: 1, 	{'train/ctc_loss': 32.2030871640207, 'train/wer': 2.489979252435938, 'validation/ctc_loss': 31.204958966954806, 'validation/wer': 2.350620383334138, 'validation/num_examples': 5348, 'test/ctc_loss': 31.23872021250658, 'test/wer': 2.4326569577316026, 'test/num_examples': 2472, 'score': 83.98095393180847, 'total_duration': 155.9855420589447, 'accumulated_submission_time': 83.98095393180847, 'accumulated_eval_time': 71.45974493026733, 'accumulated_logging_time': 0}
I0315 21:45:17.045341 139834555340544 logging_writer.py:48] [1] accumulated_eval_time=71.4597, accumulated_logging_time=0, accumulated_submission_time=83.981, global_step=1, preemption_count=0, score=83.981, test/ctc_loss=31.2387, test/num_examples=2472, test/wer=2.43266, total_duration=155.986, train/ctc_loss=32.2031, train/wer=2.48998, validation/ctc_loss=31.205, validation/num_examples=5348, validation/wer=2.35062
I0315 21:45:18.719961 139834463086336 logging_writer.py:48] [1] global_step=1, grad_norm=19.4902, loss=32.5397
I0315 21:45:18.723556 139854132851904 submission.py:265] 1) loss = 32.540, grad_norm = 19.490
I0315 21:45:19.603413 139834555340544 logging_writer.py:48] [2] global_step=2, grad_norm=24.7239, loss=33.1015
I0315 21:45:19.606872 139854132851904 submission.py:265] 2) loss = 33.101, grad_norm = 24.724
I0315 21:45:20.482779 139834463086336 logging_writer.py:48] [3] global_step=3, grad_norm=33.4022, loss=31.9926
I0315 21:45:20.486459 139854132851904 submission.py:265] 3) loss = 31.993, grad_norm = 33.402
I0315 21:45:21.361647 139834555340544 logging_writer.py:48] [4] global_step=4, grad_norm=42.4101, loss=29.651
I0315 21:45:21.365213 139854132851904 submission.py:265] 4) loss = 29.651, grad_norm = 42.410
I0315 21:45:22.231495 139834463086336 logging_writer.py:48] [5] global_step=5, grad_norm=47.6159, loss=26.3927
I0315 21:45:22.235023 139854132851904 submission.py:265] 5) loss = 26.393, grad_norm = 47.616
I0315 21:45:23.114297 139834555340544 logging_writer.py:48] [6] global_step=6, grad_norm=31.2722, loss=22.7845
I0315 21:45:23.118323 139854132851904 submission.py:265] 6) loss = 22.784, grad_norm = 31.272
I0315 21:45:23.993229 139834463086336 logging_writer.py:48] [7] global_step=7, grad_norm=23.098, loss=20.5868
I0315 21:45:23.999336 139854132851904 submission.py:265] 7) loss = 20.587, grad_norm = 23.098
I0315 21:45:24.872175 139834555340544 logging_writer.py:48] [8] global_step=8, grad_norm=20.4629, loss=18.2891
I0315 21:45:24.875796 139854132851904 submission.py:265] 8) loss = 18.289, grad_norm = 20.463
I0315 21:45:25.741935 139834463086336 logging_writer.py:48] [9] global_step=9, grad_norm=18.8777, loss=16.7277
I0315 21:45:25.745601 139854132851904 submission.py:265] 9) loss = 16.728, grad_norm = 18.878
I0315 21:45:26.620555 139834555340544 logging_writer.py:48] [10] global_step=10, grad_norm=15.0765, loss=14.5111
I0315 21:45:26.624444 139854132851904 submission.py:265] 10) loss = 14.511, grad_norm = 15.076
I0315 21:45:27.502321 139834463086336 logging_writer.py:48] [11] global_step=11, grad_norm=12.8415, loss=13.15
I0315 21:45:27.506125 139854132851904 submission.py:265] 11) loss = 13.150, grad_norm = 12.841
I0315 21:45:28.375722 139834555340544 logging_writer.py:48] [12] global_step=12, grad_norm=10.9541, loss=11.9075
I0315 21:45:28.379224 139854132851904 submission.py:265] 12) loss = 11.907, grad_norm = 10.954
I0315 21:45:29.250077 139834463086336 logging_writer.py:48] [13] global_step=13, grad_norm=9.64342, loss=11.3635
I0315 21:45:29.253399 139854132851904 submission.py:265] 13) loss = 11.363, grad_norm = 9.643
I0315 21:45:30.136147 139834555340544 logging_writer.py:48] [14] global_step=14, grad_norm=10.5021, loss=10.72
I0315 21:45:30.140281 139854132851904 submission.py:265] 14) loss = 10.720, grad_norm = 10.502
I0315 21:45:31.007870 139834463086336 logging_writer.py:48] [15] global_step=15, grad_norm=20.5212, loss=10.1583
I0315 21:45:31.011419 139854132851904 submission.py:265] 15) loss = 10.158, grad_norm = 20.521
I0315 21:45:31.886983 139834555340544 logging_writer.py:48] [16] global_step=16, grad_norm=9.99105, loss=10.1153
I0315 21:45:31.890372 139854132851904 submission.py:265] 16) loss = 10.115, grad_norm = 9.991
I0315 21:45:32.761802 139834463086336 logging_writer.py:48] [17] global_step=17, grad_norm=9.49316, loss=9.63495
I0315 21:45:32.765928 139854132851904 submission.py:265] 17) loss = 9.635, grad_norm = 9.493
I0315 21:45:33.637688 139834555340544 logging_writer.py:48] [18] global_step=18, grad_norm=7.48147, loss=9.25433
I0315 21:45:33.641638 139854132851904 submission.py:265] 18) loss = 9.254, grad_norm = 7.481
I0315 21:45:35.491054 139834463086336 logging_writer.py:48] [19] global_step=19, grad_norm=11.7988, loss=8.98047
I0315 21:45:35.494845 139854132851904 submission.py:265] 19) loss = 8.980, grad_norm = 11.799
I0315 21:45:36.501432 139834555340544 logging_writer.py:48] [20] global_step=20, grad_norm=37.0262, loss=9.42865
I0315 21:45:36.504785 139854132851904 submission.py:265] 20) loss = 9.429, grad_norm = 37.026
I0315 21:45:37.528247 139834463086336 logging_writer.py:48] [21] global_step=21, grad_norm=7.58619, loss=9.34249
I0315 21:45:37.532334 139854132851904 submission.py:265] 21) loss = 9.342, grad_norm = 7.586
I0315 21:45:38.524289 139834555340544 logging_writer.py:48] [22] global_step=22, grad_norm=8.55073, loss=9.21358
I0315 21:45:38.527970 139854132851904 submission.py:265] 22) loss = 9.214, grad_norm = 8.551
I0315 21:45:40.308572 139834463086336 logging_writer.py:48] [23] global_step=23, grad_norm=7.72714, loss=8.80475
I0315 21:45:40.312111 139854132851904 submission.py:265] 23) loss = 8.805, grad_norm = 7.727
I0315 21:45:41.319377 139834555340544 logging_writer.py:48] [24] global_step=24, grad_norm=5.75384, loss=8.53823
I0315 21:45:41.323150 139854132851904 submission.py:265] 24) loss = 8.538, grad_norm = 5.754
I0315 21:45:42.944345 139834463086336 logging_writer.py:48] [25] global_step=25, grad_norm=10.008, loss=8.60205
I0315 21:45:42.947932 139854132851904 submission.py:265] 25) loss = 8.602, grad_norm = 10.008
I0315 21:45:43.816752 139834555340544 logging_writer.py:48] [26] global_step=26, grad_norm=7.71736, loss=8.27442
I0315 21:45:43.820149 139854132851904 submission.py:265] 26) loss = 8.274, grad_norm = 7.717
I0315 21:45:45.017013 139834463086336 logging_writer.py:48] [27] global_step=27, grad_norm=3.2269, loss=7.65449
I0315 21:45:45.021126 139854132851904 submission.py:265] 27) loss = 7.654, grad_norm = 3.227
I0315 21:45:46.342081 139834555340544 logging_writer.py:48] [28] global_step=28, grad_norm=5.71056, loss=7.64747
I0315 21:45:46.345883 139854132851904 submission.py:265] 28) loss = 7.647, grad_norm = 5.711
I0315 21:45:48.057829 139834463086336 logging_writer.py:48] [29] global_step=29, grad_norm=5.36479, loss=7.48626
I0315 21:45:48.061118 139854132851904 submission.py:265] 29) loss = 7.486, grad_norm = 5.365
I0315 21:45:48.933407 139834555340544 logging_writer.py:48] [30] global_step=30, grad_norm=7.13382, loss=7.3587
I0315 21:45:48.937005 139854132851904 submission.py:265] 30) loss = 7.359, grad_norm = 7.134
I0315 21:45:50.266656 139834463086336 logging_writer.py:48] [31] global_step=31, grad_norm=9.87369, loss=7.5173
I0315 21:45:50.270826 139854132851904 submission.py:265] 31) loss = 7.517, grad_norm = 9.874
I0315 21:45:51.241438 139834555340544 logging_writer.py:48] [32] global_step=32, grad_norm=12.373, loss=7.2787
I0315 21:45:51.245093 139854132851904 submission.py:265] 32) loss = 7.279, grad_norm = 12.373
I0315 21:45:52.770680 139834463086336 logging_writer.py:48] [33] global_step=33, grad_norm=16.6966, loss=7.64696
I0315 21:45:52.774344 139854132851904 submission.py:265] 33) loss = 7.647, grad_norm = 16.697
I0315 21:45:53.855972 139834555340544 logging_writer.py:48] [34] global_step=34, grad_norm=18.6828, loss=7.38941
I0315 21:45:53.859976 139854132851904 submission.py:265] 34) loss = 7.389, grad_norm = 18.683
I0315 21:45:55.008671 139834463086336 logging_writer.py:48] [35] global_step=35, grad_norm=15.4013, loss=8.15452
I0315 21:45:55.012567 139854132851904 submission.py:265] 35) loss = 8.155, grad_norm = 15.401
I0315 21:45:55.909344 139834555340544 logging_writer.py:48] [36] global_step=36, grad_norm=3.1328, loss=6.76188
I0315 21:45:55.913416 139854132851904 submission.py:265] 36) loss = 6.762, grad_norm = 3.133
I0315 21:45:57.638800 139834463086336 logging_writer.py:48] [37] global_step=37, grad_norm=8.7028, loss=6.8048
I0315 21:45:57.642125 139854132851904 submission.py:265] 37) loss = 6.805, grad_norm = 8.703
I0315 21:45:58.684957 139834555340544 logging_writer.py:48] [38] global_step=38, grad_norm=16.3975, loss=6.97703
I0315 21:45:58.688160 139854132851904 submission.py:265] 38) loss = 6.977, grad_norm = 16.398
I0315 21:45:59.588391 139834463086336 logging_writer.py:48] [39] global_step=39, grad_norm=28.1442, loss=8.51178
I0315 21:45:59.591762 139854132851904 submission.py:265] 39) loss = 8.512, grad_norm = 28.144
I0315 21:46:00.780949 139834555340544 logging_writer.py:48] [40] global_step=40, grad_norm=14.7167, loss=9.25362
I0315 21:46:00.784330 139854132851904 submission.py:265] 40) loss = 9.254, grad_norm = 14.717
I0315 21:46:02.250730 139834463086336 logging_writer.py:48] [41] global_step=41, grad_norm=17.3761, loss=7.92682
I0315 21:46:02.254144 139854132851904 submission.py:265] 41) loss = 7.927, grad_norm = 17.376
I0315 21:46:03.688352 139834555340544 logging_writer.py:48] [42] global_step=42, grad_norm=22.3527, loss=8.21343
I0315 21:46:03.691821 139854132851904 submission.py:265] 42) loss = 8.213, grad_norm = 22.353
I0315 21:46:04.699083 139834463086336 logging_writer.py:48] [43] global_step=43, grad_norm=14.5683, loss=7.78873
I0315 21:46:04.702658 139854132851904 submission.py:265] 43) loss = 7.789, grad_norm = 14.568
I0315 21:46:05.860529 139834555340544 logging_writer.py:48] [44] global_step=44, grad_norm=7.17589, loss=6.93378
I0315 21:46:05.863797 139854132851904 submission.py:265] 44) loss = 6.934, grad_norm = 7.176
I0315 21:46:07.308918 139834463086336 logging_writer.py:48] [45] global_step=45, grad_norm=4.35493, loss=6.75012
I0315 21:46:07.312812 139854132851904 submission.py:265] 45) loss = 6.750, grad_norm = 4.355
I0315 21:46:08.384984 139834555340544 logging_writer.py:48] [46] global_step=46, grad_norm=6.92178, loss=6.92521
I0315 21:46:08.388354 139854132851904 submission.py:265] 46) loss = 6.925, grad_norm = 6.922
I0315 21:46:09.323857 139834463086336 logging_writer.py:48] [47] global_step=47, grad_norm=4.18941, loss=6.77195
I0315 21:46:09.327316 139854132851904 submission.py:265] 47) loss = 6.772, grad_norm = 4.189
I0315 21:46:10.897202 139834555340544 logging_writer.py:48] [48] global_step=48, grad_norm=2.92821, loss=6.73361
I0315 21:46:10.900586 139854132851904 submission.py:265] 48) loss = 6.734, grad_norm = 2.928
I0315 21:46:12.342898 139834463086336 logging_writer.py:48] [49] global_step=49, grad_norm=7.46534, loss=6.76579
I0315 21:46:12.346133 139854132851904 submission.py:265] 49) loss = 6.766, grad_norm = 7.465
I0315 21:46:13.220026 139834555340544 logging_writer.py:48] [50] global_step=50, grad_norm=12.5215, loss=7.02774
I0315 21:46:13.223478 139854132851904 submission.py:265] 50) loss = 7.028, grad_norm = 12.521
I0315 21:46:14.431514 139834463086336 logging_writer.py:48] [51] global_step=51, grad_norm=15.3396, loss=7.40704
I0315 21:46:14.435636 139854132851904 submission.py:265] 51) loss = 7.407, grad_norm = 15.340
I0315 21:46:15.850293 139834555340544 logging_writer.py:48] [52] global_step=52, grad_norm=18.9573, loss=7.48757
I0315 21:46:15.853757 139854132851904 submission.py:265] 52) loss = 7.488, grad_norm = 18.957
I0315 21:46:17.256947 139834463086336 logging_writer.py:48] [53] global_step=53, grad_norm=20.759, loss=8.71949
I0315 21:46:17.261155 139854132851904 submission.py:265] 53) loss = 8.719, grad_norm = 20.759
I0315 21:46:18.123715 139834555340544 logging_writer.py:48] [54] global_step=54, grad_norm=19.7706, loss=7.46081
I0315 21:46:18.127187 139854132851904 submission.py:265] 54) loss = 7.461, grad_norm = 19.771
I0315 21:46:19.382322 139834463086336 logging_writer.py:48] [55] global_step=55, grad_norm=18.5693, loss=8.41855
I0315 21:46:19.386076 139854132851904 submission.py:265] 55) loss = 8.419, grad_norm = 18.569
I0315 21:46:20.486106 139834555340544 logging_writer.py:48] [56] global_step=56, grad_norm=10.8651, loss=6.97568
I0315 21:46:20.489320 139854132851904 submission.py:265] 56) loss = 6.976, grad_norm = 10.865
I0315 21:46:22.113404 139834463086336 logging_writer.py:48] [57] global_step=57, grad_norm=7.58861, loss=7.00978
I0315 21:46:22.116755 139854132851904 submission.py:265] 57) loss = 7.010, grad_norm = 7.589
I0315 21:46:23.247773 139834555340544 logging_writer.py:48] [58] global_step=58, grad_norm=9.62098, loss=6.94845
I0315 21:46:23.251168 139854132851904 submission.py:265] 58) loss = 6.948, grad_norm = 9.621
I0315 21:46:24.559277 139834463086336 logging_writer.py:48] [59] global_step=59, grad_norm=11.0186, loss=7.14544
I0315 21:46:24.562835 139854132851904 submission.py:265] 59) loss = 7.145, grad_norm = 11.019
I0315 21:46:25.568278 139834555340544 logging_writer.py:48] [60] global_step=60, grad_norm=14.8537, loss=7.22433
I0315 21:46:25.571710 139854132851904 submission.py:265] 60) loss = 7.224, grad_norm = 14.854
I0315 21:46:26.902523 139834463086336 logging_writer.py:48] [61] global_step=61, grad_norm=15.0568, loss=8.0572
I0315 21:46:26.905966 139854132851904 submission.py:265] 61) loss = 8.057, grad_norm = 15.057
I0315 21:46:28.742052 139834555340544 logging_writer.py:48] [62] global_step=62, grad_norm=11.7051, loss=7.09839
I0315 21:46:28.745399 139854132851904 submission.py:265] 62) loss = 7.098, grad_norm = 11.705
I0315 21:46:29.622654 139834463086336 logging_writer.py:48] [63] global_step=63, grad_norm=12.9462, loss=7.41341
I0315 21:46:29.626230 139854132851904 submission.py:265] 63) loss = 7.413, grad_norm = 12.946
I0315 21:46:30.817269 139834555340544 logging_writer.py:48] [64] global_step=64, grad_norm=14.7212, loss=7.61702
I0315 21:46:30.820488 139854132851904 submission.py:265] 64) loss = 7.617, grad_norm = 14.721
I0315 21:46:31.891529 139834463086336 logging_writer.py:48] [65] global_step=65, grad_norm=12.9203, loss=7.43741
I0315 21:46:31.894895 139854132851904 submission.py:265] 65) loss = 7.437, grad_norm = 12.920
I0315 21:46:33.851264 139834555340544 logging_writer.py:48] [66] global_step=66, grad_norm=10.5432, loss=6.97028
I0315 21:46:33.854763 139854132851904 submission.py:265] 66) loss = 6.970, grad_norm = 10.543
I0315 21:46:34.724186 139834463086336 logging_writer.py:48] [67] global_step=67, grad_norm=8.60573, loss=6.98623
I0315 21:46:34.727380 139854132851904 submission.py:265] 67) loss = 6.986, grad_norm = 8.606
I0315 21:46:35.601389 139834555340544 logging_writer.py:48] [68] global_step=68, grad_norm=6.47845, loss=7.09038
I0315 21:46:35.604674 139854132851904 submission.py:265] 68) loss = 7.090, grad_norm = 6.478
I0315 21:46:36.776683 139834463086336 logging_writer.py:48] [69] global_step=69, grad_norm=3.18513, loss=6.72785
I0315 21:46:36.780052 139854132851904 submission.py:265] 69) loss = 6.728, grad_norm = 3.185
I0315 21:46:38.760859 139834555340544 logging_writer.py:48] [70] global_step=70, grad_norm=2.64129, loss=6.56993
I0315 21:46:38.764308 139854132851904 submission.py:265] 70) loss = 6.570, grad_norm = 2.641
I0315 21:46:39.639620 139834463086336 logging_writer.py:48] [71] global_step=71, grad_norm=5.77222, loss=6.74288
I0315 21:46:39.643068 139854132851904 submission.py:265] 71) loss = 6.743, grad_norm = 5.772
I0315 21:46:40.525263 139834555340544 logging_writer.py:48] [72] global_step=72, grad_norm=6.76795, loss=6.81895
I0315 21:46:40.528792 139854132851904 submission.py:265] 72) loss = 6.819, grad_norm = 6.768
I0315 21:46:41.564271 139834463086336 logging_writer.py:48] [73] global_step=73, grad_norm=12.7895, loss=7.30876
I0315 21:46:41.567638 139854132851904 submission.py:265] 73) loss = 7.309, grad_norm = 12.790
I0315 21:46:43.374829 139834555340544 logging_writer.py:48] [74] global_step=74, grad_norm=18.0526, loss=8.37199
I0315 21:46:43.379055 139854132851904 submission.py:265] 74) loss = 8.372, grad_norm = 18.053
I0315 21:46:44.255581 139834463086336 logging_writer.py:48] [75] global_step=75, grad_norm=20.2502, loss=8.11854
I0315 21:46:44.259148 139854132851904 submission.py:265] 75) loss = 8.119, grad_norm = 20.250
I0315 21:46:45.924966 139834555340544 logging_writer.py:48] [76] global_step=76, grad_norm=19.2807, loss=9.2167
I0315 21:46:45.928181 139854132851904 submission.py:265] 76) loss = 9.217, grad_norm = 19.281
I0315 21:46:46.805106 139834463086336 logging_writer.py:48] [77] global_step=77, grad_norm=11.3557, loss=7.62141
I0315 21:46:46.808684 139854132851904 submission.py:265] 77) loss = 7.621, grad_norm = 11.356
I0315 21:46:48.205524 139834555340544 logging_writer.py:48] [78] global_step=78, grad_norm=6.48796, loss=7.01689
I0315 21:46:48.208973 139854132851904 submission.py:265] 78) loss = 7.017, grad_norm = 6.488
I0315 21:46:49.079979 139834463086336 logging_writer.py:48] [79] global_step=79, grad_norm=5.35272, loss=7.00283
I0315 21:46:49.083502 139854132851904 submission.py:265] 79) loss = 7.003, grad_norm = 5.353
I0315 21:46:51.020039 139834555340544 logging_writer.py:48] [80] global_step=80, grad_norm=2.06749, loss=6.6865
I0315 21:46:51.023666 139854132851904 submission.py:265] 80) loss = 6.686, grad_norm = 2.067
I0315 21:46:51.896786 139834463086336 logging_writer.py:48] [81] global_step=81, grad_norm=2.26909, loss=6.78669
I0315 21:46:51.900452 139854132851904 submission.py:265] 81) loss = 6.787, grad_norm = 2.269
I0315 21:46:52.881877 139834555340544 logging_writer.py:48] [82] global_step=82, grad_norm=2.2434, loss=6.69349
I0315 21:46:52.885148 139854132851904 submission.py:265] 82) loss = 6.693, grad_norm = 2.243
I0315 21:46:53.757568 139834463086336 logging_writer.py:48] [83] global_step=83, grad_norm=1.52129, loss=6.63109
I0315 21:46:53.760759 139854132851904 submission.py:265] 83) loss = 6.631, grad_norm = 1.521
I0315 21:46:55.765309 139834555340544 logging_writer.py:48] [84] global_step=84, grad_norm=3.87002, loss=6.81219
I0315 21:46:55.769002 139854132851904 submission.py:265] 84) loss = 6.812, grad_norm = 3.870
I0315 21:46:56.638279 139834463086336 logging_writer.py:48] [85] global_step=85, grad_norm=7.45516, loss=6.91324
I0315 21:46:56.642260 139854132851904 submission.py:265] 85) loss = 6.913, grad_norm = 7.455
I0315 21:46:57.558866 139834555340544 logging_writer.py:48] [86] global_step=86, grad_norm=10.9616, loss=7.06953
I0315 21:46:57.562360 139854132851904 submission.py:265] 86) loss = 7.070, grad_norm = 10.962
I0315 21:46:58.433933 139834463086336 logging_writer.py:48] [87] global_step=87, grad_norm=13.2341, loss=7.70147
I0315 21:46:58.437224 139854132851904 submission.py:265] 87) loss = 7.701, grad_norm = 13.234
I0315 21:47:00.561085 139834555340544 logging_writer.py:48] [88] global_step=88, grad_norm=15.8047, loss=7.48823
I0315 21:47:00.565258 139854132851904 submission.py:265] 88) loss = 7.488, grad_norm = 15.805
I0315 21:47:01.434938 139834463086336 logging_writer.py:48] [89] global_step=89, grad_norm=15.369, loss=8.80203
I0315 21:47:01.438612 139854132851904 submission.py:265] 89) loss = 8.802, grad_norm = 15.369
I0315 21:47:02.613727 139834555340544 logging_writer.py:48] [90] global_step=90, grad_norm=12.6667, loss=7.14482
I0315 21:47:02.617424 139854132851904 submission.py:265] 90) loss = 7.145, grad_norm = 12.667
I0315 21:47:03.497390 139834463086336 logging_writer.py:48] [91] global_step=91, grad_norm=15.6891, loss=8.31919
I0315 21:47:03.500663 139854132851904 submission.py:265] 91) loss = 8.319, grad_norm = 15.689
I0315 21:47:05.938633 139834555340544 logging_writer.py:48] [92] global_step=92, grad_norm=22.1534, loss=8.71664
I0315 21:47:05.942644 139854132851904 submission.py:265] 92) loss = 8.717, grad_norm = 22.153
I0315 21:47:06.813453 139834463086336 logging_writer.py:48] [93] global_step=93, grad_norm=18.4474, loss=10.7061
I0315 21:47:06.817240 139854132851904 submission.py:265] 93) loss = 10.706, grad_norm = 18.447
I0315 21:47:07.775332 139834555340544 logging_writer.py:48] [94] global_step=94, grad_norm=2.79116, loss=6.69599
I0315 21:47:07.779029 139854132851904 submission.py:265] 94) loss = 6.696, grad_norm = 2.791
I0315 21:47:08.651378 139834463086336 logging_writer.py:48] [95] global_step=95, grad_norm=2.54412, loss=6.59812
I0315 21:47:08.655280 139854132851904 submission.py:265] 95) loss = 6.598, grad_norm = 2.544
I0315 21:47:10.525208 139834555340544 logging_writer.py:48] [96] global_step=96, grad_norm=1.08268, loss=6.85462
I0315 21:47:10.528775 139854132851904 submission.py:265] 96) loss = 6.855, grad_norm = 1.083
I0315 21:47:11.405831 139834463086336 logging_writer.py:48] [97] global_step=97, grad_norm=2.20962, loss=6.86013
I0315 21:47:11.409691 139854132851904 submission.py:265] 97) loss = 6.860, grad_norm = 2.210
I0315 21:47:12.843842 139834555340544 logging_writer.py:48] [98] global_step=98, grad_norm=3.47604, loss=6.72602
I0315 21:47:12.847322 139854132851904 submission.py:265] 98) loss = 6.726, grad_norm = 3.476
I0315 21:47:14.422626 139834463086336 logging_writer.py:48] [99] global_step=99, grad_norm=2.92911, loss=6.79115
I0315 21:47:14.426651 139854132851904 submission.py:265] 99) loss = 6.791, grad_norm = 2.929
I0315 21:47:15.649179 139834555340544 logging_writer.py:48] [100] global_step=100, grad_norm=4.39038, loss=6.82701
I0315 21:47:15.652589 139854132851904 submission.py:265] 100) loss = 6.827, grad_norm = 4.390
[rank5]: Traceback (most recent call last):
[rank5]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank5]:     app.run(main)
[rank5]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank5]:     _run_main(main, args)
[rank5]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank5]:     sys.exit(main(argv))
[rank5]:              ^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank5]:     score = score_submission_on_workload(
[rank5]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank5]:     timing, metrics = train_once(workload, workload_name,
[rank5]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank5]:     optimizer_state, model_params, model_state = update_params(
[rank5]:                                                  ^^^^^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank5]:     optimizer_state['optimizer'].step()
[rank5]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank5]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank5]:     out = func(*args, **kwargs)
[rank5]:           ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank5]:     return func(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank5]:     self._per_group_step(
[rank5]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank5]:     return func(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank5]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank5]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank5]:     return func(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank5]:     return fn(*args, **kwargs)
[rank5]:            ^^^^^^^^^^^^^^^^^^^
[rank5]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank5]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank5]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank5]:     raise ValueError(
[rank5]: ValueError: Encountered nan values in bias-corrected factor matrix 4.block_4.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 4.block_4.0: torch.min(factor_matrix)=tensor(nan, device='cuda:5'), torch.max(factor_matrix)=tensor(nan, device='cuda:5'), factor_matrix.isinf().any()=tensor(False, device='cuda:5'), factor_matrix.isnan().any()=tensor(True, device='cuda:5').
[rank6]: Traceback (most recent call last):
[rank6]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank6]:     app.run(main)
[rank6]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank6]:     _run_main(main, args)
[rank6]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank6]:     sys.exit(main(argv))
[rank6]:              ^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank6]:     score = score_submission_on_workload(
[rank6]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank6]:     timing, metrics = train_once(workload, workload_name,
[rank6]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank6]:     optimizer_state, model_params, model_state = update_params(
[rank6]:                                                  ^^^^^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank6]:     optimizer_state['optimizer'].step()
[rank6]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank6]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank6]:     out = func(*args, **kwargs)
[rank6]:           ^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank6]:     return func(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank6]:     self._per_group_step(
[rank6]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank6]:     return func(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank6]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank6]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank6]:     return func(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank6]:     return fn(*args, **kwargs)
[rank6]:            ^^^^^^^^^^^^^^^^^^^
[rank6]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank6]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank6]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank6]:     raise ValueError(
[rank6]: ValueError: Encountered nan values in bias-corrected factor matrix 0.block_0.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 0.block_0.0: torch.min(factor_matrix)=tensor(nan, device='cuda:6'), torch.max(factor_matrix)=tensor(nan, device='cuda:6'), factor_matrix.isinf().any()=tensor(False, device='cuda:6'), factor_matrix.isnan().any()=tensor(True, device='cuda:6').
[rank0]: Traceback (most recent call last):
[rank0]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank0]:     app.run(main)
[rank0]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank0]:     _run_main(main, args)
[rank0]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank0]:     sys.exit(main(argv))
[rank0]:              ^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank0]:     score = score_submission_on_workload(
[rank0]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank0]:     timing, metrics = train_once(workload, workload_name,
[rank0]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank0]:     optimizer_state, model_params, model_state = update_params(
[rank0]:                                                  ^^^^^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank0]:     optimizer_state['optimizer'].step()
[rank0]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank0]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank0]:     out = func(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank0]:     self._per_group_step(
[rank0]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank0]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank0]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank0]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank0]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank0]:     raise ValueError(
[rank0]: ValueError: Encountered nan values in bias-corrected factor matrix 2.block_0.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 2.block_0.0: torch.min(factor_matrix)=tensor(nan, device='cuda:0'), torch.max(factor_matrix)=tensor(nan, device='cuda:0'), factor_matrix.isinf().any()=tensor(False, device='cuda:0'), factor_matrix.isnan().any()=tensor(True, device='cuda:0').
[rank4]: Traceback (most recent call last):
[rank4]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank4]:     app.run(main)
[rank4]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank4]:     _run_main(main, args)
[rank4]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank4]:     sys.exit(main(argv))
[rank4]:              ^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank4]:     score = score_submission_on_workload(
[rank4]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank4]:     timing, metrics = train_once(workload, workload_name,
[rank4]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank4]:     optimizer_state, model_params, model_state = update_params(
[rank4]:                                                  ^^^^^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank4]:     optimizer_state['optimizer'].step()
[rank4]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank4]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank4]:     out = func(*args, **kwargs)
[rank4]:           ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank4]:     return func(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank4]:     self._per_group_step(
[rank4]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank4]:     return func(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank4]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank4]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank4]:     return func(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank4]:     return fn(*args, **kwargs)
[rank4]:            ^^^^^^^^^^^^^^^^^^^
[rank4]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank4]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank4]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank4]:     raise ValueError(
[rank4]: ValueError: Encountered nan values in bias-corrected factor matrix 4.block_3.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 4.block_3.0: torch.min(factor_matrix)=tensor(nan, device='cuda:4'), torch.max(factor_matrix)=tensor(nan, device='cuda:4'), factor_matrix.isinf().any()=tensor(False, device='cuda:4'), factor_matrix.isnan().any()=tensor(True, device='cuda:4').
[rank2]: Traceback (most recent call last):
[rank2]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank2]:     app.run(main)
[rank2]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank2]:     _run_main(main, args)
[rank2]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank2]:     sys.exit(main(argv))
[rank2]:              ^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank2]:     score = score_submission_on_workload(
[rank2]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank2]:     timing, metrics = train_once(workload, workload_name,
[rank2]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank2]:     optimizer_state, model_params, model_state = update_params(
[rank2]:                                                  ^^^^^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank2]:     optimizer_state['optimizer'].step()
[rank2]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank2]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank2]:     out = func(*args, **kwargs)
[rank2]:           ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank2]:     self._per_group_step(
[rank2]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank2]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank2]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank2]:     return fn(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank2]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank2]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank2]:     raise ValueError(
[rank2]: ValueError: Encountered nan values in bias-corrected factor matrix 4.block_1.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 4.block_1.0: torch.min(factor_matrix)=tensor(nan, device='cuda:2'), torch.max(factor_matrix)=tensor(nan, device='cuda:2'), factor_matrix.isinf().any()=tensor(False, device='cuda:2'), factor_matrix.isnan().any()=tensor(True, device='cuda:2').
[rank3]: Traceback (most recent call last):
[rank3]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank3]:     app.run(main)
[rank3]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank3]:     _run_main(main, args)
[rank3]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank3]:     sys.exit(main(argv))
[rank3]:              ^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank3]:     score = score_submission_on_workload(
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank3]:     timing, metrics = train_once(workload, workload_name,
[rank3]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank3]:     optimizer_state, model_params, model_state = update_params(
[rank3]:                                                  ^^^^^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank3]:     optimizer_state['optimizer'].step()
[rank3]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank3]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank3]:     out = func(*args, **kwargs)
[rank3]:           ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank3]:     return func(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank3]:     self._per_group_step(
[rank3]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank3]:     return func(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank3]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank3]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank3]:     return func(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank3]:     return fn(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank3]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank3]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank3]:     raise ValueError(
[rank3]: ValueError: Encountered nan values in bias-corrected factor matrix 4.block_2.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 4.block_2.0: torch.min(factor_matrix)=tensor(nan, device='cuda:3'), torch.max(factor_matrix)=tensor(nan, device='cuda:3'), factor_matrix.isinf().any()=tensor(False, device='cuda:3'), factor_matrix.isnan().any()=tensor(True, device='cuda:3').
[rank7]: Traceback (most recent call last):
[rank7]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank7]:     app.run(main)
[rank7]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank7]:     _run_main(main, args)
[rank7]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank7]:     sys.exit(main(argv))
[rank7]:              ^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank7]:     score = score_submission_on_workload(
[rank7]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank7]:     timing, metrics = train_once(workload, workload_name,
[rank7]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank7]:     optimizer_state, model_params, model_state = update_params(
[rank7]:                                                  ^^^^^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank7]:     optimizer_state['optimizer'].step()
[rank7]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank7]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank7]:     out = func(*args, **kwargs)
[rank7]:           ^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank7]:     return func(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank7]:     self._per_group_step(
[rank7]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank7]:     return func(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank7]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank7]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank7]:     return func(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank7]:     return fn(*args, **kwargs)
[rank7]:            ^^^^^^^^^^^^^^^^^^^
[rank7]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank7]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank7]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank7]:     raise ValueError(
[rank7]: ValueError: Encountered nan values in bias-corrected factor matrix 4.block_6.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 4.block_6.0: torch.min(factor_matrix)=tensor(nan, device='cuda:7'), torch.max(factor_matrix)=tensor(nan, device='cuda:7'), factor_matrix.isinf().any()=tensor(False, device='cuda:7'), factor_matrix.isnan().any()=tensor(True, device='cuda:7').
[rank1]: Traceback (most recent call last):
[rank1]:   File "/algorithmic-efficiency/submission_runner.py", line 766, in <module>
[rank1]:     app.run(main)
[rank1]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 308, in run
[rank1]:     _run_main(main, args)
[rank1]:   File "/usr/local/lib/python3.11/site-packages/absl/app.py", line 254, in _run_main
[rank1]:     sys.exit(main(argv))
[rank1]:              ^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submission_runner.py", line 734, in main
[rank1]:     score = score_submission_on_workload(
[rank1]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submission_runner.py", line 630, in score_submission_on_workload
[rank1]:     timing, metrics = train_once(workload, workload_name,
[rank1]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submission_runner.py", line 361, in train_once
[rank1]:     optimizer_state, model_params, model_state = update_params(
[rank1]:                                                  ^^^^^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/submission.py", line 241, in update_params
[rank1]:     optimizer_state['optimizer'].step()
[rank1]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
[rank1]:     return func.__get__(opt, opt.__class__)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/site-packages/torch/optim/optimizer.py", line 487, in wrapper
[rank1]:     out = func(*args, **kwargs)
[rank1]:           ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 954, in step
[rank1]:     self._per_group_step(
[rank1]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 781, in _per_group_step_impl
[rank1]:     self._compute_root_inverse(state_lists, compute_root_inverse)
[rank1]:   File "/usr/local/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 632, in _fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/distributed_shampoo.py", line 732, in _compute_root_inverse
[rank1]:     state_lists[SHAMPOO_PRECONDITIONER_LIST].compute_root_inverse()
[rank1]:   File "/algorithmic-efficiency/submissions_algorithms/leaderboard/external_tuning/shampoo_submission/optimizers/distributed_shampoo/utils/shampoo_preconditioner_list.py", line 766, in compute_root_inverse
[rank1]:     raise ValueError(
[rank1]: ValueError: Encountered nan values in bias-corrected factor matrix 4.block_0.0! To mitigate, check if nan inputs are being passed into the network or nan gradients are being passed to the optimizer.For debugging purposes, factor_matrix 4.block_0.0: torch.min(factor_matrix)=tensor(nan, device='cuda:1'), torch.max(factor_matrix)=tensor(nan, device='cuda:1'), factor_matrix.isinf().any()=tensor(False, device='cuda:1'), factor_matrix.isnan().any()=tensor(True, device='cuda:1').
[rank0]:[W315 21:53:27.082118135 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
W0315 21:53:30.468000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 45 closing signal SIGTERM
W0315 21:53:30.469000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 46 closing signal SIGTERM
W0315 21:53:30.469000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 47 closing signal SIGTERM
W0315 21:53:30.469000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 48 closing signal SIGTERM
W0315 21:53:30.469000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 49 closing signal SIGTERM
W0315 21:53:30.470000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 50 closing signal SIGTERM
W0315 21:53:30.470000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 51 closing signal SIGTERM
E0315 21:53:33.156000 9 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 44) of binary: /usr/local/bin/python3.11
Traceback (most recent call last):
  File "/usr/local/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/usr/local/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/usr/local/lib/python3.11/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/usr/local/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
submission_runner.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-03-15_21:53:30
  host      : 3df54dc010ad
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 44)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
